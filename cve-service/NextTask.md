# Enhanced Vulnerability Scanning ## Implementation Plan

# Goal
정규식 기반의 단순한 의존성 추출 방식을 **전용 파서(Maven Model, Gradle Tooling API)**로 교체하여 Maven 및 Gradle 프로젝트 지원을 강화하고, CPE 매칭 알고리즘을 개선하여 취약점 탐지 정확도를 높입니다.

# Proposed Changes

## 1. Dependency Extraction (Parser Replacement)
Dependencies
cve-service/build.gradle
에 다음 라이브러리 추가
Maven: org.apache.maven:maven-model:3.9.6 (pom.xml 파싱)
Gradle: org.gradle:gradle-tooling-api:8.5 (Gradle 프로젝트 분석)
Architecture
ProjectDependencyParser 인터페이스 정의
MavenDependencyParser: MavenXpp3Reader를 사용하여 pom.xml 파싱
GradleDependencyParser: Gradle Tooling API를 사용하여 의존성 모델 조회
ProjectScanService
: 프로젝트 타입에 따라 적절한 파서 주입 및 사용

## 2. CPE Matching Improvement
[NEW] 
CpeMatchingService.java
단순 문자열 일치 외에 다양한 매칭 전략 구현
Normalization: spring-web -> spring_web (하이픈을 언더스코어로 변환)
Vendor Check: Group ID에 Vendor 이름이 포함되는지 확인 (오탐 방지)
Keyword Extraction: Artifact ID에서 핵심 키워드 추출하여 매칭

## 3. Refactoring
VulnerabilityMatcherService
에서 매칭 로직을 CpeMatchingService로 위임
Verification Plan
Automated Tests
Maven Parsing: 샘플 pom.xml을 파싱하여 의존성 목록이 정확히 추출되는지 테스트
CPE Matching: 다양한 케이스(하이픈, 대소문자 등)에 대한 매칭 로직 단위 테스트
Manual Verification
실제 Maven 프로젝트 및 Gradle 프로젝트 경로로 스캔 API 호출
로그를 통해 파싱된 의존성 목록과 매칭된 CVE 확인